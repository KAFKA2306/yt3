---
description: 日次本番パイプラインの実行・監視・レジューム
---

# /run — 制作と配信の聖典

本ワークフローは、YT3プロジェクトにおける「最高品質の動画を毎日世界に届ける」という至高の目的を達成するための、運用・監視の全工程を網羅するものである。

---

## 1. 制作の儀式（新規実行）

新しい動画制作を開始する際は、以下の手順を厳粛に遂行せよ。

### ステップ1：インフラの覚醒
パイプラインが依存する全てのサービス（Voicevox, Aim, Discord Bot等）を起動し、準備を整える。
// turbo
```bash
npx tsx scripts/tasks.ts up
```

### ステップ2：全自動制作の執行
メインエンジンを起動し、リサーチからアップロードまでを一気通貫で実行する。
// turbo
```bash
npx tsx scripts/tasks.ts run
```

---

## 2. 監視と介入 (Monitoring & Intervention)

エージェントの活動は `logs/agent_activity.jsonl` に刻まれる。以下の状況に応じ、適切に介入せよ。

- **進行確認**: `npx tsx scripts/tasks.ts status` でコンテナとプロセスの生存を確認。
- **品質の壁**: `CriticAgent` がリジェクトを繰り返す場合は、直ちに中断し `/improve` (Tuneモード) へ移行せよ。

---

## 3. 復活の儀式（レジューム戦略）

失敗は恐れるに足りない。ただし、死体（中途半端な成果物）の処理は慎重に行え。

### ステップ1：戦況分析
失敗した `RUN_ID` (通常は `YYYY-MM-DD`) を特定し、ログから停止箇所を突き止めよ。

### ステップ2：不要な残骸の徹底排除
特に `MEDIA` フェーズ（FFmpeg）での失敗時は、中途半端な動画ファイルを削除しない限り、正常な再開は不可能である。
```bash
rm -rf runs/[RUN_ID]/media
```

### ステップ3：聖なる再開
「スマート・レジューム」機能により、完了済みのフェーズは自動的にスキップされる。
// turbo
```bash
RUN_ID=[RUN_ID] npx tsx src/index.ts
```

---

## 4. 鉄の掟：推論の統制

> [!CAUTION]
> **Gemini 3 Flash 厳守**
> 本システムは `gemini-3.0-flash-preview` の特性に最適化されている。他モデルへの切り替えは、魂を売る行為に等しい。
> **429 (Rate Limit) 発生時**: 待機してリトライするのではなく、**「今日はもう実行しない」** という選択をせよ。これは、APIへの敬意であり、システムの安定性を守るための勇気ある撤退である。

---

## 5. 終幕（クリーンアップ）

制作完了後、不要なバックグラウンドプロセスを停止させ、リソースを解放せよ。
// turbo
```bash
npx tsx scripts/tasks.ts down
```