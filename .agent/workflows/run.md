---
description: 日次本番パイプラインの実行・監視・再開の手順
---

# /run — 運用ガイドライン

このワークフローは、YT3プロジェクトにおいて「高品質な動画を毎日安定して配信する」という目的を達成するための、運用および監視の全工程をまとめたものです。

---

## 1. 制作手順（新規実行）

新しい動画制作を開始する際は、以下の手順に従って進めてください。

### ステップ1：インフラの起動
パイプラインが依存するすべてのサービス（Voicevox, Aim, Discord Bot等）を起動し、準備を整えます。
// turbo
```bash
npx tsx scripts/tasks.ts up
```

### ステップ2：全自動制作の実行
メインエンジンを起動し、情報の収集からアップロードまでを一括で実行します。
// turbo
```bash
npx tsx scripts/tasks.ts run
```

---

## 2. 監視と対応 (Monitoring & Intervention)

各エージェントの処理内容は `logs/agent_activity.jsonl` に記録されます。状況に応じて、以下の通り適切に対応してください。

- **進行状況の確認**: `npx tsx scripts/tasks.ts status` を実行し、コンテナとプロセスの稼働状況を確認してください。
- **品質チェック**: `CriticAgent` がリジェクトを繰り返す場合は、直ちに処理を中断し、`/improve` (Tuneモード) でプロンプトや設定の調整を行ってください。

---

## 3. 再開手順（レジューム戦略）

処理が失敗した場合は、以下の手順で安全に再開してください。

### ステップ1：状況分析
失敗した `RUN_ID` (通常は `YYYY-MM-DD`) を特定し、ログから停止した箇所を確認してください。

### ステップ2：不要な中間ファイルの削除
特に `MEDIA` フェーズ（FFmpeg）で失敗した場合は、作成途中の動画ファイルを削除する必要があります。削除しない場合、正常に再開できないことがあります。
```bash
rm -rf runs/[RUN_ID]/media
```

### ステップ3：処理の再開
「スマート・レジューム」機能により、完了済みのフェーズは自動的にスキップされます。以下のコマンドで再開してください。
// turbo
```bash
RUN_ID=[RUN_ID] npx tsx src/index.ts
```

---

## 4. 完了後の検証 (Verification)

制作完了後は、成果物が基準を満たしているか、以下の手順で最終確認を行ってください。

### ステップ1：成果物の確認
生成された動画ファイル（`runs/[RUN_ID]/output.mp4`等）を再生し、音声、字幕、映像に不自然な点がないか目視で確認してください。

### ステップ2：配信結果の確認
YouTube StudioおよびXの投稿画面を確認し、タイトル、説明文、タグが正しく設定されているか、また初期の反応（表示回数など）を観測してください。

### ステップ3：インフラの停止
すべての検証が完了したら、バックグラウンドプロセスを停止してください。
// turbo
```bash
npx tsx scripts/tasks.ts down
```

---

## 5. 運用ポリシー：モデルの制限

> [!IMPORTANT]
> **Gemini 3 Flash の使用推奨**
> 本システムは `gemini-3.0-flash-preview` の特性に最適化されています。原則として、他のモデルへの切り替えは行わないでください。
> **429 (Rate Limit) 発生時の対応**: APIのレート制限に達した場合は、繰り返しのリトライは避け、**「その日の実行は中止する」** という判断を検討してください。これはシステムの安定性を維持し、APIのクォータを適切に管理するための措置です。