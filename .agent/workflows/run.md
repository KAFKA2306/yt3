---
description: 日次本番パイプラインの実行・監視・再開の手順
---

# /run — 運用ガイドライン

このワークフローは、YT3プロジェクトにおいて「高品質な動画を毎日安定して配信する」という目的を達成するための、運用および監視の全工程をまとめたものです。

---

## 1. 制作手順（新規実行）

新しい動画制作を開始する際は、以下の手順に従って進めてください。

### ステップ 1：サービスの起動
パイプラインが依存するすべてのサービス（Voicevox, Discord Bot 等）を起動し、準備を整えます。
// turbo
```bash
npx tsx scripts/tasks.ts up
```

### ステップ 2：全自動制作の実行
メインエンジンを起動し、情報の収集からアップロードまでを一括で実行します。
// turbo
```bash
npx tsx scripts/tasks.ts run
```

---

## 2. 監視と対応 (Monitoring & Intervention)

エージェントの処理内容は `logs/agent_activity.jsonl` に記録されます。状況に応じて、以下の通り適切に対応してください。

- **進行状況の確認**: `npx tsx scripts/tasks.ts status` を実行し、プロセスの稼働状況を確認してください。
- **品質チェック**: 評価エージェント（CriticAgent）がリジェクトを繰り返す場合は、直ちに処理を中断し、`/improve` ワークフローを用いてプロンプトや設定の調整を行ってください。

---

## 3. 再開手順（レジューム戦略）

何らかの原因で処理が失敗した場合は、以下の手順で安全に再開してください。

### ステップ 1：状況の分析
失敗した `RUN_ID` (通常は `YYYY-MM-DD`) を特定し、ログから停止した箇所を確認してください。

### ステップ 2：中間ファイルの整理
特に `MEDIA` フェーズ（動画合成）で失敗した場合は、作成途中の動画ファイルを一旦削除してください。古いファイルが残っていると、正常に再開できない場合があります。
```bash
rm -rf runs/[RUN_ID]/media
```

### ステップ 3：処理の再開
「スマート・レジューム」機能により、完了済みのフェーズは自動的にスキップされます。以下のコマンドで再開してください。
// turbo
```bash
RUN_ID=[RUN_ID] npx tsx src/index.ts
```

---

## 4. 完了後の検証 (Verification)

制作完了後は、成果物が基準を満たしているか、最終確認を行います。

### ステップ 1：成果物の目視確認
生成された動画ファイル（`runs/[RUN_ID]/output.mp4` 等）を再生し、音声、字幕、映像に不自然な点がないか確認してください。

### ステップ 2：配信状況の確認
YouTube Studio および X (Twitter) の投稿画面を確認し、タイトル、説明文、タグが正しく設定されているかを確認します。

### ステップ 3：サービスの停止
すべての検証が完了したら、バックグラウンドプロセスを停止してください。
// turbo
```bash
npx tsx scripts/tasks.ts down
```

---

## 5. 運用ポリシー：モデルの制限

> [!IMPORTANT]
> **Gemini 3 Flash の使用**
> 本システムは `gemini-3.0-flash-preview` に最適化されています。原則として、他のモデルへの切り替えは行わないでください。
> **API レート制限発生時の対応**: API のレート制限（429 エラー）に達した場合は、過度なリトライを避け、その日の実行を中止することを検討してください。これは、クォータの適切な管理とシステムの安定性を優先するための措置です。