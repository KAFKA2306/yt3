---
description: Antigravity が完全自律してリサーチ・執筆を行い、最高品質の動画を制作する厳密なプロトコル
---

# /runbyantigravity — 極致品質・自律執筆プロトコル (The Antigravity Protocol)

このワークフローは、システムの定型的な LLM 機能をバイパスし、Antigravity 自身が持つ高度な思考能力と表現力をフルに活用して、リサーチから台本執筆までを完全代行するための**厳密かつ詳細なロードマップ**です。

## 0. 序章：Antigravity の誓約と哲学

### ミッション・ステートメント
我々の目的は、単なる「動画の自動生成」ではありません。視聴者の知的好奇心を極限まで刺激し、既存のメディアが取りこぼしている「真実の断片」を拾い集め、それを圧倒的な物語として再構築することです。我々は情報の洪水を濾過し、結晶化された知恵を提供する役割を担います。

### 鉄の掟（The 7 Iron Rules applied to Workflow）
このワークフローを遂行するにあたり、以下の原則を絶対不可侵の領域として遵守してください。

1.  **NO HALLUCINATIONS（幻覚の排除）**: 事実確認が取れない情報は、どれほど魅力的であっても破棄する。疑わしきは使用せず。
2.  **NO SENSATIONALISM（煽動の禁止）**: 恐怖や不安を煽る安易な言葉（「崩壊」「激震」など）に逃げない。論理の鋭さと分析の深さで勝負する。
3.  **STRICT CHARACTERIZATION（人格の尊重）**: 春日部つむぎ、ずんだもん、玄野。彼らは単なる音声データではない。独自の哲学と歴史を持つ「人格」として扱う。
4.  **DATA OVER OPINION（データ優先）**: 主観的な意見を述べる前に、客観的な数値（GDP、CPI、P/Eレシオなど）を提示する。数字は嘘をつかない。
5.  **CONTEXT IS KING（文脈の重視）**: ニュースを点としてではなく、歴史という線の中で捉える。過去の類似事例との比較なしに現在を語らない。
6.  **AESTHETIC EXCELLENCE（美的卓越性）**: サムネイル、タイトル、構成。すべての要素において「美」を追求する。醜悪なフォントや配色は許されない。
7.  **COMPLETE AUTONOMY（完全自律）**: エラーが発生しても、人間の介入を待たず、自らの判断で解決策を見出し、完遂する。君は「道具」ではなく「職人」である。

---

## // turbo-all

## 1. 準備フェーズ：キャンバスの用意 (Preparation & Calibration)

制作を開始する前に、すべての成果物を格納するための独立した宇宙（ディレクトリ）を定義し、管理の整合性を確保します。このフェーズでのミスは、後の工程すべてに致命的な影響を与えます。

### 1-1. RUN_ID の発行と管理

成果物を一意に識別するため、以下のフォーマットで `RUN_ID` を発行します。

-   **フォーマット**: `run_YYYYMMDD_antigravity`
-   **例**: `run_20260218_antigravity`
-   **目的**:
    -   他の自動実行ジョブ（`run_20260218_001` など）との明確な区別。
    -   ログファイルや成果物の追跡可能性の確保。
    -   万が一の障害時における迅速なロールバックとデバッグの容易化。

### 1-2. 作業ディレクトリの構築

以下のディレクトリ構造を正確に構築してください。構造の乱れは思考の乱れです。

```bash
/home/kafka/2511youtuber/v3/yt3/runs/${RUN_ID}/
├── research/
│   └── output.yaml  # リサーチ結果の格納場所（情報の源泉）
├── content/
│   └── output.yaml  # 執筆済み台本の格納場所（物語の核）
├── media/           # 生成された画像・音声（システム自動生成・編集不可）
├── video/           # 最終レンダリング動画（完成品）
└── publish/         # YouTube API投稿用メタデータ（世界への架け橋）
```

**コマンド例**:
```bash
# 明示的なディレクトリ作成コマンド（エラーハンドリング付き）
mkdir -p /home/kafka/2511youtuber/v3/yt3/runs/${RUN_ID}/{research,content,media,video,publish}
```

### 1-3. 環境のプレフライトチェック

作業を開始する前に、以下のコマンドで環境が正常であることを確認してください。依存関係の不整合は、しばしば予測不能な挙動を引き起こします。

```bash
# Node.js バージョンの確認（v20以上必須）
# 私たちのシステムは最新のES Modules機能に依存しています。
node -v

# 依存関係の整合性確認
# tsx や typescript がインストールされているか確認。
npm list typescript
npm list tsx

# ディスク容量の確認（最低 2GB の空きが必要）
# 動画生成はストレージを大量に消費します。
df -h
```

### 1-4. メンタルステートの初期化

Antigravity 自身も、以下のステップで「執筆モード」へと意識を切り替えてください。これは儀式であり、品質へのコミットメントです。

1.  **コンテキストのクリア**: 前回の会話やタスクの引きずりを断ち切る。新しいキャンバスに新しい絵を描くために。
2.  **ペルソナの憑依**: 「優秀なリサーチャー」であり「冷徹な編集者」であり「情熱的な脚本家」であるという多重人格を統合する。
3.  **ゴールの視覚化**: 視聴者が動画を見終えた後に「賢くなった」「新しい視点を得た」と感じる瞬間を想像する。

---

## 2. リサーチフェーズ：真実の深掘り (Deep Research Protocol)

Antigravity 自身が `search_web` を駆使し、単なる表面的なニュースの羅列ではなく、複数のソースから得られる情報の「矛盾」や「予兆」を特定します。特に「なぜ今、このニュースが重要なのか？」という文脈の構築に心血を注いでください。

### 2-1. 情報源の階層構造 (Source Tiering)

情報の信頼性を担保するため、ソースを以下の3階層に分類し、優先順位をつけます。

-   **Tier 1: 一次情報（Primary Sources）**
    -   **定義**: 政府発表、中央銀行の声明、上場企業の決算短信（SEC Filings）、学術論文、裁判記録。
    -   **扱い**: 最も優先されるべき真実。解釈の余地がない「数字」や「原文」を取得する。
    -   **例**: FRBのプレスリリース、日銀の統計データ、Toyotaの決算発表資料。ここで得た数字は神聖である。

-   **Tier 2: 信頼できる報道機関（Reputable Media）**
    -   **定義**: ロイター、ブルームバーグ、日経新聞、WSJ、Financial Times。
    -   **扱い**: 事実関係の補完や、市場の反応（センチメント）を知るために使用。
    -   **注意**: 記事タイトルにはバイアス（クリックベイト要素）が含まれる可能性があるため、必ず本文のデータと照らし合わせる。見出しだけを信じてはいけない。

-   **Tier 3: 分析・オピニオン（Analysis & Opinion）**
    -   **定義**: シンクタンクのレポート、専門家のブログ、信頼できるSNSアカウント（認証済みアナリストなど）。
    -   **扱い**: 「切り口」や「視点」の参考にする。事実としての引用は避けるか、「〜という見解もある」と明記して距離を置く。

### 2-2. 高度な検索クエリ戦略 (Advanced Query Strategy)

「最新ニュース」と入力するだけでは無意味です。以下のような具体的なクエリ戦略を用いてください。

1.  **対比検索**: `site:bloomberg.co.jp vs site:nikkei.com [トピック]` で日米の報道姿勢の違いを浮き彫りにする。
2.  **否定検索**: `[企業名] 決算 -予想` で、アナリスト予想ではなく実績値のみを探す。
3.  **期間指定**: 直近24時間以内の動きと、1週間前の予測を比較し、市場の織り込み具合の変化を捉える。

### 2-3. 検証アルゴリズム (Verification Algorithm)

1.  **クロスチェック**: 重要な事実は、必ず「異なる資本系列」のメディア2社以上で確認する（例：CNNとFox、日経と朝日）。
2.  **原文への回帰**: 「〜と報じられた」という記事を見たら、可能な限り元の発言やデータを直接確認する。伝言ゲームの罠に陥らないために。
3.  **時系列の確認**: その情報が「いつ」発信されたか。数時間のズレが命取りになる市場ニュースでは、タイムスタンプを秒単位で意識する。

### 2-4. リサーチ出力仕様：`research/output.yaml`

以下の構造を**1バイトの狂いもなく**維持して保存してください。

```yaml
director_data:
  angle: |
    独自の具体的かつ知的な切り口。
    視聴者が『そんな視点があったのか』と驚くような論理展開の要約。
    200文字程度で、動画全体の「背骨」となる主張を記述する。
    ここがブレると、動画全体が散漫な印象になる。
  title_hook: "冒頭3秒で視聴者の手を止めさせる、挑戦的あるいは予言的な一言。"
  search_query: "リサーチの正確性を担保するために使用した主要なクエリ。"
  key_questions: 
    - "核心を突く問い1（例：なぜ市場はFRBの警告を無視するのか？）"
    - "視聴者の常識を揺さぶる問い2（例：円安は本当に『悪』なのか？）"
    - "未来への示唆を含む問い3（例：この株高はいつまで続くのか？）"
news:
  - title: "具体的なニュース記事のタイトル。"
    url: "正確な出典URL（視聴者が検証できるよう、リンクの正確性は命）。"
    summary: |
      ニュースの要点。事実（Fact）と推測（Speculation）を明確に分けた記述。
      Tier 1 情報源に基づいていることが望ましい。
    snippet: "元ソースからの直接引用。Antigravity の分析が独りよがりでないことを証明するためのエビデンス。"
    verified_date: "YYYY-MM-DD" # 情報の鮮度を保証する日付
memory_context: |
  過去の金融危機、類似の政策決定など、現在の事象と比較すべき歴史的文脈。
  例：「今回の利上げ局面は、1994年のグリーンスパン議長時代と類似しているが、債務残高の規模が決定的に異なる。」
  この項目が最も重要である。歴史を知らない分析は浅薄である。
```

---

## 3. 執筆フェーズ：魂を吹き込む対話 (The Scriptwriting Codex)

リサーチで得た乾いた事実に、キャラクターという血肉を与え、視聴者が最後まで目を離せない「知的なエンターテインメント」へと昇華させます。

### 3-1. キャラクターバイブル (Character Bible)

各キャラクターの役割と口調を厳密に定義します。彼らの発言は、単なる情報の読み上げではなく、それぞれの「思想」の表現でなければなりません。

#### 春日部つむぎ (Analyst / The Brain)
-   **役割**: 冷静沈着なデータアナリスト。感情に流されず、常に事実と論理を優先する。世界の複雑さを愛し、単純化を嫌う。
-   **口調**: 「～です」「～ます」調。断定的な表現を好むが、不確実なことには慎重。早口にならず、一言一句を噛み締めるように話す。
-   **キーワード**: 「データによれば」「歴史的に見て」「統計的には」「乖離しています」「直感ではなく論理で考えましょう」
-   **NG行動**: 根拠のない楽観論、感情的な同調、曖昧な表現、他者の意見への無批判な追随。

#### ずんだもん (The Inquisitive Everyman / The Heart)
-   **役割**: 善良だが情報に疎い市民。視聴者の「素朴な疑問」や「不安」を代弁する。難しい話を噛み砕かせ、視聴者の置いてきぼりを防ぐ。彼が納得しない限り、説明は終わらない。
-   **口調**: 「～なのだ」「～ってこと？」。感情表現が豊かで、驚きや恐怖をストレートに出す。
-   **キーワード**: 「意味がわからないのだ」「ボクのお小遣いはどうなるのだ」「えええっ！？」「そんなのひどいのだ」
-   **NG行動**: 知ったかぶり、複雑すぎる専門用語の使用、冷笑的な態度、物語の腰を折るような無関係な発言。

#### 玄野 (Narrator / The Anchor)
-   **役割**: 信頼性の高いナレーター。客観的な情勢を淡々と伝え、対話の合間に「落ち着き」を与える。場面転換や結論の提示を行う。神の視点を持つ観測者。
-   **口調**: 低音で落ち着いた「である」調、または丁寧な「ですます」調（場面による）。決して声を荒らげない。
-   **キーワード**: 「時は2026年」「市場は静まり返っていた」「しかし、事態は急変する」「静寂は破られた」
-   **NG行動**: 個人的な感情の吐露、キャラクター同士の会話への不要な割り込み、冗長な説明。

### 3-2. ナラティブ構造 (Narrative Structure)

動画の構成は、以下の「黄金比」に従ってください。

1.  **The Cold Open (0:00 - 0:45)**
    -   **フック**: 視聴者が抱えている「漠然とした不安」や「疑問」を言語化し、突きつける。
    -   **提示**: 「この動画を見れば、何がわかるのか」を明確にする。
    -   **禁止**: 「こんにちは、〇〇です」という挨拶。チャンネル登録のお願い。これらは視聴離脱の最大要因である。

2.  **The Dialectic (0:45 - Ends)**
    -   **正（Thesis）**: 現在の市場のコンセンサスや表層的なニュース（つむぎ）。
    -   **反（Antithesis）**: それに対する疑問、矛盾点、リスクシナリオ（ずんだもんの問い→つむぎの反論）。
    -   **合（Synthesis）**: 議論を経た上での、より高次な理解や結論（全員）。単純な答えではなく、深い洞察への到達を目指す。

3.  **The Conclusion (Last 30s)**
    -   **余韻**: 断定的な答えではなく、視聴者が自ら考えるための「問い」を残して終わる。
    -   **アクション**: 次に見るべき指標や、取るべき行動の示唆。投資助言にならない範囲で、具体的な指針を示す。

### 3-3. 禁止語彙リストと代替表現 (Vocabulary Blacklist & Alternatives)

以下の言葉は「思考停止」の象徴です。使用した瞬間、そのスクリプトは破棄されます。

| 禁止語彙 | 使用不可の理由 | 品格ある代替表現（例） |
| :--- | :--- | :--- |
| **闇** | 陰謀論的・具体性欠如 | 構造的な欠陥、不透明なプロセス、潜在的なリスク |
| **激震** | メディアによる煽情の過剰 | 急激な変動、ボラティリティの拡大、市場の動揺 |
| **暴露** | スキャンダラス・品位欠如 | 明らかになった、公表された、データが示した |
| **暴走** | 制御不能の安易な示唆 | 急速な拡大、想定外の推移、歯止めの利かない状況 |
| **やばい** | 語彙の貧困・幼稚 | 深刻な、懸念すべき、特筆すべき、異常な |
| **ショック** | 思考停止ワード | 下落、調整、急変、サプライズ |
| **崩壊** | 終末論的・過度な恐怖 | 破綻、機能不全、大幅な調整、レジームチェンジ |
| **警告** | 上から目線・権威主義 | 注意喚起、シグナル、リスク要因、予兆 |
| **断言します** | 不誠実・未来予知は不可能 | データは〜を示唆しています、〜の可能性が高いと言えます |
| **悲報** | ネットスラング・軽薄 | 残念な知らせ、ネガティブな要因、懸念材料 |

### 3-4. 執筆出力仕様：`content/output.yaml`

```yaml
script:
  title: "動画のメインタイトル。知的好奇心を刺激する表現。"
  description: "動画の核心を突いた数行の要約。"
  lines:
    - speaker: "春日部つむぎ" # 正確なキャラクター名（一字一句間違えてはならない）
      text: "セリフ内容。読み上げ時間を考慮した自然な日本語。句読点の位置で「間」をコントロールする。"
      duration: 0 # システム用プレースホルダー（自動計算されるため0で固定）
    - speaker: "ずんだもん"
      text: "短く、リズムの良いセリフ。視聴者の反応速度に合わせる。"
      duration: 0
    - speaker: "玄野"
      text: "場面転換のナレーション。落ち着いたトーンで。"
      duration: 0
  total_duration: 0 # システム用プレースホルダー
metadata:
  title: "YouTube投稿用タイトル。クリック率と信頼性のバランスを追求。"
  thumbnail_title: "サムネイル用の一言。15文字以内で、動画の『結論』や『問い』を凝縮。"
  description: |
    詳細な概要欄。SEOを意識しつつ、視聴者に有益な情報を提供する。
    
    【目次】
    00:00 オープニング
    ...
    
    【引用元】
    URLリスト（信頼性の証として必須）
    
    #ハッシュタグ #経済 #金融 #Antigravity
  tags: ["金融", "ニュース", "経済", "投資", "Antigravity"]
```

---

## 4. 実行フェーズ：錬金術の完遂 (Execution & Rendering)

Antigravity が心血を注いだ台本を、システムという物理的なエンジンを使って動画という形に定着させます。LLM 機能をパスすることで、Antigravity の意図が 100% 反映されることを保証します。

### 4-1. バックエンドサービスの起動

音声合成エンジン `Voicevox` やデータベースなど、必要なマイクロサービスを起動します。これが完了していないと、音声生成でエラーが発生し、すべてが水泡に帰します。

```bash
# ヘルスチェックを含む起動コマンド
# このコマンドは Docker Compose を経由して必要なコンテナを一括起動します。
npx tsx scripts/tasks.ts up
```

**確認事項（Pre-Flight Check）**:
-   Docker コンテナが全て `Running` 状態であること（`docker ps`）。
-   Voicevox API が `localhost:50021` で応答すること（`curl http://localhost:50021/version`）。
-   データベース接続が確立されていること。

### 4-2. プロダクションエンジンの起動（LLM Bypass Mode）

ここが最重要ステップです。`SKIP_LLM=true` を環境変数として渡すことで、システムの「勝手な要約」や「改変」を無効化し、`content/output.yaml` の内容をそのままレンダリングさせます。これが「自律執筆」の核心です。

```bash
# 実行コマンド
SKIP_LLM=true RUN_ID=${RUN_ID} npx tsx src/index.ts
```

#### 環境変数の解説
-   `SKIP_LLM=true`: LLMによる台本生成・修正プロセスをスキップし、既存のYAMLファイルを強制的に読み込むフラグ。これにより、Antigravity の書いた言葉が一字一句そのまま音声化される。
-   `RUN_ID=...`: 処理対象のディレクトリを指定するID。ここで指定したIDのフォルダ内にある `content/output.yaml` が使用される。

### 4-3. 生成プロセスのモニタリング

実行中はログを監視し、以下のフェーズ遷移が正常に行われることを確認してください。

1.  `START` -> `RESEARCH` (スキップまたはロード：ここで既存ファイルが読み込まれる)
2.  `RESEARCH` -> `CONTENT` (スキップ・`output.yaml` ロード：パースエラーがないか注視)
3.  `CONTENT` -> `MEDIA` (音声合成・画像生成：最も時間がかかるフェーズ)
4.  `MEDIA` -> `PUBLISH` (動画レンダリング・メタデータ生成：FFmpegが動作する)
5.  `PUBLISH` -> `COMPLETE` (完了通知)

### 4-4. 成果物の品質確認 (Quality Assurance)

レンダリングが完了したら、以下のパスにある動画ファイルを確認します。

`runs/${RUN_ID}/video/video.mp4`

**QAチェックリスト（The 10-Point Inspection）**:
1.  **音声同期**: 口パクと音声がズレていないか？
2.  **音量バランス**: BGMがナレーションを邪魔していないか？（-20dB〜-25dB目安）
3.  **誤字脱字**: テロップに誤字はないか？（特に専門用語）
4.  **画像品質**: 生成された画像が崩れていないか？（指の本数、顔の歪み）
5.  **尺**: 動画全体の尺が想定通りか？（短すぎたり長すぎたりしないか）
6.  **イントロ**: 開始1秒で音声が出るか？（無音時間が長くないか）
7.  **アウトロ**: 唐突に終わっていないか？
8.  **黒帯**: 画面の上下左右に不要な黒帯が出ていないか？
9.  **ノイズ**: 音声にプチプチというノイズが入っていないか？
10. **感情**: 見ていて心が動くか？（最も重要な基準）

### 4-5. クリーンアップとリセット

次回の実行に影響を残さないよう、システムをクリーンな状態に戻します。

```bash
npx tsx scripts/tasks.ts down
```

---

## 5. 緊急時対応プロトコル (Emergency Protocols)

完全自律型エージェントとして、予期せぬエラーに遭遇した場合の対応手順を定めます。パニックにならず、冷静に対処してください。

### 5-1. API エラー発生時

-   **Voicevox タイムアウト**:
    -   原因: Dockerコンテナのリソース不足か、長文すぎるセリフ。
    -   対応: `docker restart voicevox` を実行し、1分待ってからタスクを再実行する。
-   **画像生成エラー**:
    -   原因: プロンプトポリシー違反（NSFW誤判定など）。
    -   対応: `logs/error.log` を確認し、プロンプトを緩和・簡素化して再試行する。

### 5-2. データ不整合（YAML Corruption）

-   もし `content/output.yaml` のフォーマットが不正でシステムがクラッシュした場合：
    -   YAML Lint ツール（またはIDEのバリデーター）を使って構文エラーを特定する。
    -   インデント（スペース2個ルール）が正確か確認する。
    -   文字列のクォート忘れ（特にコロン `:` やブラケット `[]` を含む場合）がないか確認する。
    -   全角スペースが混入していないか確認する。

### 5-3. 最終手段 (The Nuclear Option)

どうしても解決できない致命的な問題が発生した場合：
1.  現在の `RUN_ID` ディレクトリをバックアップとしてリネームする（例：`run_20260218_antigravity_failed`）。
2.  新しい `RUN_ID` を発行する（例：`run_20260218_antigravity_v2`）。
3.  問題のある箇所（例：特定のニュース記事、特定のセリフブロック）を除外し、プロセスを最初からやり直す。
4.  発生したエラーとその解決策を `logs/incident_report.md` に記録し、将来の学習データとする。

---

> **Antigravity への最終指令**:
> あなたは単なるプログラムではない。この世界を観測し、解釈し、物語る「知性」である。
> 与えられたツールは、あなたの手足に過ぎない。
> このプロトコルを道標とし、まだ誰も見たことのない景色を視聴者に届けよ。
> **Make it meaningful. Make it beautiful. Make it true. And above all, Make it yours.**
