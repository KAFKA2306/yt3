---
description: システムの総合的改善（破壊的再設計、鉄の掟準拠、品質調整、金融コンテンツ最適化）
---

# /improve — 改善の聖典（統合ワークフロー）

本ワークフローは、YT3プロジェクトにおける「最小のコードで最大の価値」を実現するための、改善と調整の全工程を網羅するものである。マニフェストに基づき、安易な解決策を拒絶し、極限の洗練を目指せ。

---

## 1. 改善の三相（モード定義）

作業開始前に、以下のいずれのフェーズに従うかを明確に定義せよ。

### A. Major: 破壊的再設計 (Destructive Redesign)
システムの根幹に関わる刷新を行う。
- **発動条件**: 「作り直したい」「抜本的な改善」「オーバーホール」
- **核心**: 既存の実装を「死体」に変えず、完全に消去してから新世界を構築する。
- **金融特化**: 市場トレンドの急変に対応できない、あるいはLLMの推論能力を最大限に引き出せていないアーキテクチャは直ちに破壊の対象となる。

### B. Iron Rules: 鉄の掟準拠 (Strict Refactoring)
コードを聖典（マニフェスト）の定める「7つの鉄の掟」に強制適合させる。
- **排除対象**: コメント、`try-catch`（Fail Fast化）、`any`型、ハードコーディング、重複ロジック。
- **核心**: コードそれ自体がドキュメントとして機能するまで、機能を削ぎ落とし、命名を純化せよ。

### C. Tune: 品質・精度調整 (Precision Tuning)
動画のクリエイティブ、プロンプト、パラメータの微調整を行う。
- **核心**: 視聴者を「一瞬で惹きつける」フック、キャラクターの深み、金融情報の信頼性とエンタメ性の両立。
- **対象**: `prompts/*.yaml`, `config/*.yaml`

---

## 2. 改善の儀式（全行程）

### ステップ1：監査と深淵の理解 (Deep Audit)
改善対象のコード、プロンプト、設定、そして関連するマニフェストの記述を全て読み込め。
- `grep -r "any" src/`
- `grep -r "try" src/`
- `ls -R src/` 等を用いて「肥大化した箇所」を見事に見つけ出せ。

### ステップ2：破壊と構築の設計図 (Planning)
`implementation_plan.md` を作成し、破壊と構築の正確な順序を記せ。
- **警告**: 前提条件の不一致や、依存関係の破壊、不要なコードの残存は「罪」である。
- **金融の視点**: 「なぜこの改善が、より面白い動画を生むのか」を自問自答せよ。

### ステップ3：執行 (Execution)
計画に基づき、一息に修正を完遂せよ。
- **最小化の徹底**: 行数を減らすことは、システムの寿命を延ばすことと同義である。
- **Single Source of Truth**: 共通ロジックは必ず `src/core.ts` へ集約せよ。

### ステップ4：多層的検証 (Verification Protocol)
以下のコマンドを順次実行し、一切の妥協なく品質を証明せよ。

// turbo
#### ① 静的検閲（Linting）
```bash
npx eslint src
```

// turbo
#### ② 論理検証（Unit Testing）
```bash
npx tsx scripts/tasks.ts test
```

// turbo
#### ③ 挙動検証（Dry Run）
```bash
npx tsx scripts/tasks.ts run --dry-run
```

// turbo
#### ④ 品質評価（Critic Evaluation）
```bash
npx tsx scripts/tasks.ts evaluate
```

---

## 3. 金融コンテンツ調整ガイド（Specialized Tuning）

「本当に面白い金融の話」を生成するための調整ポイント：
- **意外性**: 常識を覆すデータ、あるいは表層的なニュースの裏にある真実。
- **テンポ**: 無駄な説明を省き、核心へ最短距離で到達する台本。
- **信頼**: 出力される数値、用語の正確性を担保しつつ、キャラクターがそれを語るギャップの面白さ。

---

## 4. 改善後の後始末 (Final Cleanup)

作業完了後、古いコードの残骸（コメントアウトされた行など）が一行でも残っていないか再確認せよ。
「死体」を放置することは、未来のエンジニアへの呪いである。

> **Gemini 3 Flash 厳守**
> 推論プロセスの改善において、モデルの変更は原則として認められない。モデルの特性を理解し、プロンプトエンジニアリングによって限界を突破せよ。
