---
description: システムの総合的改善（大規模リデザイン、規約準拠、品質調整、コンテンツ最適化）
---

# /improve — システム改善ガイドライン

このワークフローは、YT3プロジェクトにおいて「最小のコードで最大の価値」を実現するための、改善と調整の全工程をまとめたものです。開発マニフェストに基づき、安易な解決策を避け、常に洗練された設計を目指してください。

---

## 1. 改善の三段階（モード定義）

作業開始前に、以下のいずれのフェーズに従うかを明確に定義してください。

### A. 大規模リデザイン (Destructive Redesign)
システムの根幹に関わる刷新を行います。
- **適用条件**: 抜本的な改善やオーバーホールが必要な場合。
- **方針**: 既存の実装を部分的に修正するのではなく、必要に応じて一度整理し、新しい設計に基づき構築し直します。
- **金融特化**: 市場トレンドの急変に対応できない、あるいはLLMの能力を最大限に引き出せていないアーキテクチャは、速やかに刷新の対象としてください。

### B. 規約準拠 (Strict Refactoring)
コードをマニフェストで定める「7つの鉄の掟」に適合させます。
- **修正対象**: 不要なコメント、不明確なエラーハンドリング（Fail Fast化）、`any`型の使用、ハードコーディング、重複ロジック。
- **方針**: コード自体がその意図を明確に伝えるドキュメントとして機能するよう、冗長さを削ぎ落とし、命名を最適化してください。

### C. チューニング (Precision Tuning)
動画のクリエイティブ、プロンプト、パラメータの微調整を行います。
- **方針**: 視聴者を惹きつける「フック」、キャラクターの深み、金融情報の信頼性とエンタメ性の両立を目指します。
- **対象**: `prompts/*.yaml`, `config/*.yaml`

---

## 2. 改善の手順

### ステップ1：現状の分析と把握 (Deep Audit)
改善対象のコード、プロンプト、設定、および関連するマニフェストの記述を詳しく確認してください。
- `grep -r "any" src/`
- `grep -r "try" src/`
- `ls -R src/` 等を用いて、改善が必要な箇所（肥大化した部分など）を特定してください。

### ステップ2：改善計画の作成 (Planning)
`implementation_plan.md` を作成し、修正の正確な順序を記述してください。
- **注意**: 前提条件の不一致、依存関係の切断、不要なコードの残存がないよう慎重に計画してください。
- **コンテンツの視点**: 「この改善が、どのように動画の魅力向上につながるのか」を常に意識してください。

### ステップ3：実装 (Execution)
計画に基づき、修正を完遂してください。
- **コードの最小化**: 行数を減らすことは、システムの保守性を高めることに直結します。
- **Single Source of Truth**: 共通ロジックは必ず `src/core.ts` へ集約してください。

### ステップ4：検証 (Verification Protocol)
以下のコマンドを順次実行し、品質を確認してください。

// turbo
#### ① 静的解析（Linting）
```bash
npx eslint src
```

// turbo
#### ② 論理検証（ユニットテスト）
```bash
npx tsx scripts/tasks.ts test
```

// turbo
#### ③ 動作検証（ドライラン）
```bash
npx tsx scripts/tasks.ts run --dry-run
```

// turbo
#### ④ 品質評価（Criticエージェントによる評価）
```bash
npx tsx scripts/tasks.ts evaluate
```

---

## 3. 金融コンテンツ調整ガイド

「質の高い金融コンテンツ」を生成するための調整ポイント：
- **意外性**: 一般的な知識だけでなく、データに基づいた独自の視点や最新の情報を盛り込みます。
- **テンポ**: 無駄な説明を省き、核心に素早く到達する構成を目指します。
- **信頼性とキャラクター性**: 数値や用語の正確性を担保しつつ、キャラクターらしい話し方で親しみやすさを演出します。

---

## 4. 完了後の整理 (Final Cleanup)

作業完了後、古いコードの残骸や不要なコメントが残っていないか再確認してください。クリーンなコードベースを維持することが、将来のメンテナンスにおいて極めて重要です。

> **Gemini 3 Flash の適切な利用**
> 推論プロセスの改善において、モデルの変更は原則として認められません。モデルの特性を深く理解し、プロンプトエンジニアリングによってその能力を最大限に引き出してください。
