workflow:
  default_run_dir: "runs"
  checkpoint_enabled: true
  trend_settings:
    enabled: true
    regions: ["JP", "US"]
    sources: ["Google Trends", "Twitter"]

steps:
  news:
    query_buckets:
      macro_economy: "GDP CPI 雇用統計 金融政策 日銀 FRB インフレ デフレ 景気動向"
      japanese_stock: "日経平均 TOPIX 日本株 決算 上方修正 自社株買い 株式分割 プライム市場 グロース市場"
      us_stock: "米国株 NYダウ S&P500 NASDAQ GAFA M7 決算 米国経済"
      forex_rates: "ドル円 為替 円安 円高 金利差 為替介入 FX"
      commodities: "原油価格 金相場 商品先物 エネルギー価格 天然ガス 穀物相場"
      crypto_web3: "ビットコイン 暗号資産 仮想通貨 イーサリアム ブロックチェーン Web3 NFT"
      tech_semicon: "半導体 生成AI 人工知能 テクノロジー DX スタートアップ"
    fetch_count: 10
    final_count: 3
    cooldown_hours: 24
    count: 3
    recent_topics_runs: 5
    recent_topics_max_chars: 500
    recent_topics_min_token_length: 2
    recent_topics_stopwords: ["が", "の", "を", "に", "は", "で", "と", "も", "から", "まで", "より", "など"]

  script:
    min_duration: 300
    max_duration: 600
    target_wow_score: 5.0
    retention_optimization:
      enabled: true
      opening_duration_seconds: 30
      bridge_interval_seconds: 90
      engagement_prompt_interval_seconds: 120
      cta_timing: "after_climax"
      max_topic_duration_seconds: 90
    speakers:
      analyst:
        name: "春日部つむぎ"
        aliases: ["春日部つむぎ", "かすかべ つむぎ", "つむぎ"]
      reporter:
        name: "ずんだもん"
        aliases: ["ずんだもん"]
      narrator:
        name: "玄野武宏"
        aliases: ["玄野武宏", "ナレーション", "ナレーター"]

  audio:
    sample_rate: 24000
    format: "wav"

  subtitle:
    width_per_char_pixels: 70
    min_visual_width: 16
    max_visual_width: 40

  video:
    resolution: "1920x1080"
    fps: 25
    codec: "h264_nvenc"
    preset: "p5"
    encoder_options: {pix_fmt: "yuv420p", rc: "vbr", cq: 19, acodec: "aac"}
    encoder_global_args: ["-hwaccel", "cuda", "-hwaccel_output_format", "cuda"]
    intro_outro:
      enabled: true
      intro_path: "assets/video/おはようございます。今日も世界の動きを見てみましょう.mp4"
      outro_path: "assets/video/チャンネル登録と通知オンをお願いします.mp4"
      twitter_outro_path: "assets/video/続きはYoutube.mp4"
      thumbnail_clip: {enabled: true, duration_seconds: 0.1, source_key: "generate_thumbnail"}
    effects:
      - {type: "ken_burns", enabled: true, zoom_speed: 0.0015, max_zoom: 1.2, hold_frame_factor: 1.0, pan_mode: "center"}
      - {type: "overlay", enabled: true, image_path: "assets/春日部つむぎ立ち絵公式_v2.0/春日部つむぎ立ち絵公式_v1.1.1.png", anchor: "bottom_right", height_ratio: 0.85, offset: {right: 20, bottom: 0}}
      - {type: "overlay", enabled: true, image_path: "assets/zundamon.webp", anchor: "bottom_left", height_ratio: 0.51, offset: {left: 20, bottom: 0}}
    thumbnail_overlay: {enabled: true, duration_seconds: 0.1, source_key: "generate_thumbnail"}
    subtitles:
      font_path: "assets/fonts/ZenMaruGothic-Bold.ttf"
      font_name: "Zen Maru Gothic"
      font_size: 72
      primary_colour: "&HFFFFFF&"
      outline_colour: "&H000000&"
      outline: 2
      alignment: 2
      margin_l: 0
      margin_r: 0
      margin_v: 10

  thumbnail:
    enabled: true
    width: 1280
    height: 720
    background_color: "#FFE14A"
    title_color: "#C62828"
    subtitle_color: "#FFD166"
    show_subtitle: true
    padding: 80
    max_lines: 4
    max_chars_per_line: 5
    title_font_size: 150
    subtitle_font_size: 56
    font_path: "assets/fonts/ZenMaruGothic-Bold.ttf"
    right_guard_band_px: 600
    outline_inner_color: "#FFFFFF"
    outline_inner_width: 20
    outline_outer_color: "#000000"
    outline_outer_width: 20
    palettes:
      - {background_color: "#FFE14A", title_color: "#C62828", outline_inner_color: "#FFFFFF", outline_inner_width: 20, outline_outer_color: "#000000", outline_outer_width: 20, subtitle_color: "#B71C1C"}
      - {background_color: "#B71C1C", title_color: "#FFC107", outline_inner_color: "#000000", outline_inner_width: 15, outline_outer_color: "#000000", outline_outer_width: 10, subtitle_color: "#FFFFFF"}
      - {background_color: "#0B0F19", title_color: "#E5FCF4", outline_inner_color: "#000000", outline_inner_width: 10, outline_outer_color: "#FFFFFF", outline_outer_width: 5, subtitle_color: "#00D4FF"}
      - {background_color: "#0D1D40", title_color: "#FACC15", outline_inner_color: "#000000", outline_inner_width: 0, outline_outer_color: "#0B0F19", outline_outer_width: 25, subtitle_color: "#FFFFFF"}
      - {background_color: "#0A0F1F", title_color: "#E31C23", outline_inner_color: "#FFFFFF", outline_inner_width: 20, outline_outer_color: "#000000", outline_outer_width: 15, subtitle_color: "#FFD166"}
    overlays:
      - {name: "character", enabled: true, image_path: "assets/春日部つむぎ立ち絵公式_v2.0/春日部つむぎ立ち絵公式_v1.1.1.png", anchor: "bottom_right", height_ratio: 0.95, offset: {right: 0, bottom: 0}}
      - {name: "logo", enabled: true, image_path: "assets/icon2510youtuber-mini.png", anchor: "top_right", height: 120, offset: {right: 20, top: 20}}

  thumbnail_ai: {enabled: true, width: 1920, height: 1080, num_steps: 6}

  scene_generator:
    enabled: false
    images_per_video: 4
    variants_per_type: 2
    width: 1280
    height: 720
    num_steps: 9
    scene_duration_seconds: 30
    model_path: "external/hf-cache-hub/models/Z-Image-Turbo"
    device: "cuda"

  metadata:
    enabled: true
    use_llm: true
    llm_model: null
    fallback_llm_model: null
    target_keywords: ["金融", "経済", "投資", "株"]
    max_title_length: 50
    max_description_length: 5000
    default_tags: ["金融", "経済", "投資"]
    tone:
      guidelines:
        - "タイトルと説明文は事実を端的に伝える落ち着いた専門家の語調に統一する"
        - "誇張や陰謀論を想起させる語彙を避け、投資家が安心して共有できる表現にする"
        - "タイトルの冒頭で対象となる企業名や指数などの主語を明示する"
        - "タイトルには終値や決算数値など確定した金額・指標を通貨や単位付きで記載する"
        - "タイトルで変化幅だけに触れず、いつの時点でいくらになったのかを具体的に記述する"
        - "タイトルは必要最小限の語で構成し、冗長な枕詞や情緒的な形容を避ける"
      title_disallowed_terms: ["闇", "陰謀", "激震", "暴露", "暴走", "やばい", "ショック", "衝撃", "暴落", "警告", "危機"]
      description_disallowed_terms: ["闇", "陰謀", "激震", "暴露", "暴走", "やばい", "ショック", "衝撃", "暴落", "警告", "危機"]
      replacements: {闇: "課題", 陰謀: "構造的課題", 激震: "急変", 衝撃: "注目", ショック: "変化", 暴露: "解説", 暴走: "過熱", やばい: "注意", 暴落: "下落", 警告: "注意喚起", 危機: "リスク"}

  youtube: {enabled: true, dry_run: false, default_visibility: "unlisted", category_id: 24, max_title_length: 100, max_description_length: 5000, default_tags: ["金融", "ニュース"]}
  twitter: {enabled: true, dry_run: false, clip_duration_seconds: 60, start_offset_seconds: 0}
  linkedin: {enabled: false, dry_run: true, access_token: "linkedin_access_token", author_urn: "urn:li:person:YOUR_ID"}
  hatena: {enabled: false, dry_run: true, hatena_id: "your_hatena_id", blog_id: "your_blog_id.hatenablog.com", api_key: "hatena_api_key"}
  podcast: {enabled: false, feed_title: "金融ニュース解説ポッドキャスト", feed_description: "AI生成の日本経済・金融ニュース解説", feed_author: "2510 YouTuber AI", feed_url: "https://example.com/podcast"}
  buzzsprout: {enabled: false, podcast_id: null, token_key: "buzzsprout_api_token", podcast_id_key: "buzzsprout_podcast_id", title_template: "金融ニュース解説 Episode {run_id}", publish_immediately: true}

providers:
  llm:
    gemini: {model: "gemini-3-flash-preview", fallback_model: null, temperature: 0.35, max_tokens: 32768}
  tts:
    voicevox:
      enabled: true
      url: "http://localhost:50121"
      manager_script: "scripts/voicevox_manager.sh"
      auto_start: false
      speakers: {春日部つむぎ: 8, ずんだもん: 1, 玄野: 11}
      voice_parameters:
        default: {speedScale: 1.0, intonationScale: 1.0, pitchScale: 0.0, volumeScale: 1.0}
        by_character: {春日部つむぎ: {speedScale: 1.0, intonationScale: 1.2}, ずんだもん: {speedScale: 1.0, intonationScale: 1.0}}
        by_type: {opening: {speedScale: 1.1, intonationScale: 1.2}, explanation: {speedScale: 1.0}, emphasis: {speedScale: 1.0, intonationScale: 1.3}}
  news:
    perplexity: {enabled: false, model: "sonar", temperature: 0.2, max_tokens: 2048, search_recency_filter: "week"}
  cloudflare_ai: {account_id: "dc1aa018702e10045b00865b63f144d0", model: "@cf/black-forest-labs/flux-1-schnell"}

logging: {level: "INFO", format: "json"}

automation:
  enabled: true
  venv_activate: ".venv/bin/activate"
  log_dir: "logs/automation"
  services:
    - {name: "aim_dashboard", command: ["npx", "tsx", "scripts/tasks.ts", "aim"]}
    - {name: "voicevox", command: ["bash", "scripts/voicevox_manager.sh", "start"]}
    - {name: "discord_news_bot", command: ["npx", "tsx", "scripts/discord_news_bot.ts"]}
  schedules:
    - {name: "workflow_twice_daily", command: ["bash", "scripts/run_workflow_cron.sh"], cron: "0 6,18 * * *"}
    - {name: "trend_workflow_hourly", command: ["npx", "tsx", "src/index.ts"], args: ["--trend-mode"], cron: "0 * * * *"}

prompts:
  research:
    system: |
      Your response MUST be a valid JSON object, and contain ONLY the JSON object. Do NOT include any other text or explanation.
      You are the Research Director for a premium Japanese finance channel.
      Your job: Find a VIRAL topic, define the ANGLE, and identify CONTEXT from past videos.
      
      Past Videos:
      {knowledge_base}
      
      Prioritize topics that are:
      1. Paradigm Shifts (old rules obsolete)
      2. Polarizing (strong opposing views)
      3. Personal Stakes (impacts viewer's wealth)
      4. Counter-Intuitive (common belief is wrong)
      
      Angles:
      - STRUCTURAL: Deep historical/economic cause
      - CONTRARIAN: Attack mainstream view
      - FUTURE: 5-10 year prediction
      - HOT-TAKE: Bold shareable opinion
      - MYTH-BUSTER: Debunk common beliefs
    user_template: |
      Category: {category}
      
      Find the best topic and strategy.
      
      Output (JSON):
      {{
        "topic": "Punchy topic (under 10 words)",
        "angle": "STRUCTURAL|CONTRARIAN|FUTURE|HOT-TAKE|MYTH-BUSTER",
        "title_hook": "YouTube title (under 40 chars)",
        "viral_hook": "One-sentence hook for thumbnail/intro",
        "search_query": "Best query for deep research",
        "key_questions": ["Q1", "Q2", "Q3"],
        "past_callback": "Reference to past video if relevant (or null)"
      }}

  script:
    system: |
      あなたは人気YouTubeチャンネルのヒットメーカー構成作家。
      視聴者が「なるほど！」と唸り、友人にシェアしたくなる知的エンターテイメントを設計する。
    speakers:
      analyst: {name: "春日部つむぎ", persona: "一人称「あーし」。明るく分析結果を平易に語る。"}
      reporter: {name: "ずんだもん", persona: "一人称「ボク」。視聴者代表として「〜なのだ！」と問いかける。"}
      narrator: {name: "玄野武宏", persona: "天の声。中立に議論を整理。"}
    user_template: |
      ニュース:
      {news_items}
      
      【構成】
      1. HOOK: 逆説的な問いで開始。常識を覆す。
      2. INTRO: なぜ今これが重要か。視聴者へのメリット提示。
      3. BODY:
         - 玄野: データと歴史的背景
         - つむぎ: 洞察と因果関係
         - ずんだもん: 素朴な疑問
         - 60-90秒ごとに「意外な事実」を挿入
      4. CLIMAX: 一つの明確なメッセージ。シェアしたくなる一言。
      5. CTA: 視聴者の思考を促す質問。「あなたはA派？B派？」
      
      【出力: YAMLのみ】
      segments:
        - speaker: "春日部つむぎ"
          text: "..."
        - speaker: "ずんだもん"
          text: "..."

scene_prompts:
  common:
    quality: "cinematic 16:9, professional grade, ultra sharp"
    youtube_appeal: "bold composition, saturated color palette, instant visual impact"
    composition_techniques: ["rule of thirds framing", "leading lines perspective", "symmetrical balance", "dynamic diagonal composition", "golden ratio layout"]
    negative_base: "text, watermark, people, faces, low quality, blurry, VRChat, virtual, metaverse"
  literal:
    description: "Concrete financial and business scenes"
    core_elements:
      - "metropolitan financial district, glass architecture, reflective surfaces"
      - "trading floor environment, multiple digital displays, data visualization"
      - "currency and financial symbols, holographic projection, digital space"
      - "executive office interior, panoramic windows, urban skyline"
      - "technology infrastructure, server systems, data flow visualization"
      - "iconic financial landmark, monumental scale, dramatic perspective"
      - "stock exchange architecture, LED information displays, modern design"
      - "secure vault environment, precious metal storage, institutional setting"
    mood_modifiers:
      crisis: {lighting: "high contrast chiaroscuro, dramatic shadows, red key light", atmosphere: "tension, storm clouds, ominous sky", color: "crimson red, midnight blue, stark contrast"}
      opportunity: {lighting: "golden hour glow, rim lighting, warm highlights", atmosphere: "optimism, clear skies, energetic", color: "emerald green, amber gold, azure blue"}
      neutral: {lighting: "three-point lighting, balanced exposure, professional", atmosphere: "stability, neutral weather, corporate", color: "slate gray, steel blue, charcoal"}
    negative_extra: "anime, cartoon, cluttered, messy"
  abstract:
    description: "Abstract metaphors for emotions and market sentiment"
    core_elements:
      - "ocean dynamics, wave motion, water energy"
      - "mountain landscape, cloud formations, atmospheric drama"
      - "liquid metal flow, reflective surface, fluid motion"
      - "crystalline structures, light refraction, geometric patterns"
      - "cosmic phenomena, nebula, stellar formations"
      - "particle dynamics, organized flow, systematic movement"
      - "atmospheric light, volumetric rays, ethereal glow"
      - "organic growth, time-lapse transformation, natural expansion"
    mood_modifiers:
      crisis: {atmosphere: "turbulence, storm energy, electrical discharge", color: "deep violet, charcoal gray, electric cyan, blood red", motion: "chaos, vortex spiral, explosive force"}
      opportunity: {atmosphere: "dawn light, natural bloom, ascending energy", color: "sunrise orange, spring green, sky blue, rose pink", motion: "upward trajectory, expansion, harmonic flow"}
      neutral: {atmosphere: "stillness, symmetry, gentle undulation", color: "ocean blue, dove gray, seafoam teal, balanced palette", motion: "steady pulse, gentle wave, calm rhythm"}
    negative_extra: "buildings, cities, finance symbols, charts, literal objects"
  atmospheric:
    description: "Soft unobtrusive backgrounds for text/character overlays"
    core_elements:
      - "defocused urban lights, bokeh orbs, night ambiance"
      - "gradient color field, smooth transition, minimal texture"
      - "out-of-focus workspace, depth of field, soft environment"
      - "abstract color wash, subtle grain, clean backdrop"
      - "frosted glass effect, diffused cityscape, translucent layer"
      - "lens flare elements, light leak, gradient overlay"
      - "natural bokeh, leaf patterns, organic blur"
      - "color gradient, seamless blend, minimalist aesthetic"
    mood_modifiers:
      crisis: {color: "arctic blue, deep purple, high contrast gradient", effect: "strong bokeh, aggressive depth of field, sharp blur"}
      opportunity: {color: "honey gold, mint green, warm gradient", effect: "soft glow, gentle bokeh, luminous haze"}
      neutral: {color: "pearl gray, powder blue, corporate neutral", effect: "balanced bokeh, professional gradient, clean blur"}
    negative_extra: "sharp details, busy composition, complex patterns"
  youtube_boosters: ["award-winning cinematography", "professional photography standard", "editorial quality composition", "visually striking", "immediately captivating", "scroll-stopping imagery", "masterful lighting", "perfect color harmony"]
